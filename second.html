<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>(2D Ledger Web appllication)</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        .input-section {
            margin-bottom: 20px;
        }
        .input-row {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
            flex-wrap: wrap;
            align-items: flex-end;
        }
        .input-group {
            flex: 1;
            min-width: 120px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        input, button {
            padding: 8px;
            width: 100%;
            box-sizing: border-box;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        button {
            background-color: #4CAF50;
            color: white;
            border: none;
            cursor: pointer;
            font-weight: bold;
        }
        button#function-btn {
            background-color: #2196F3;
        }
        button.danger {
            background-color: #f44336;
        }
        #r-money-group, #ahkays-group {
            display: none;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
            margin-bottom: 10px;
            font-size: 14px;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 6px;
            text-align: center;
        }
        th {
            background-color: #f2f2f2;
            position: sticky;
            top: 0;
        }
        .main-entry {
            background-color: #e8f5e9;
        }
        .r-entry {
            background-color: #fff8e1;
        }
        .identical-entry {
            background-color: #e1f5fe;
        }
        .prefix-entry {
            background-color: #f3e5f5;
        }
        .suffix-entry {
            background-color: #e8f5e9;
        }
        .break-entry {
            background-color: #ffebee;
        }
        .power-entry {
            background-color: #e8eaf6;
        }
        .nacca-entry {
            background-color: #e0f7fa;
        }
        .ahkway-entry {
            background-color: #fce4ec;
        }
        .ahput-par-ahkway-entry {
            background-color: #f3e5f5;
        }
        .function-list {
            display: none;
            position: absolute;
            background-color: #f9f9f9;
            min-width: 150px;
            box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
            z-index: 1;
        }
        .function-list a {
            color: black;
            padding: 12px 16px;
            text-decoration: none;
            display: block;
        }
        .function-list a:hover {
            background-color: #f1f1f1;
        }
        .show {
            display: block;
        }
        .summary {
            display: flex;
            justify-content: space-between;
            margin: 15px 0;
            flex-wrap: wrap;
            gap: 10px;
        }
        .summary-box {
            background-color: #e9f7ef;
            padding: 10px;
            border-radius: 5px;
            flex: 1;
            min-width: 200px;
            text-align: center;
        }
        .over-limit {
            color: red;
            font-weight: bold;
        }
        .over-limit-cell {
            background-color: #ffdddd;
        }
        .total-cell {
            background-color: #e3f2fd;
            font-weight: bold;
        }
        .total-ledger-row {
            background-color: #e3f2fd;
            font-weight: bold;
            text-align: center;
            padding: 8px;
            margin: 10px 0;
            border-radius: 5px;
            border: 1px solid #ddd;
        }
        .table-container {
            max-height: 300px;
            overflow-y: auto;
            margin-bottom: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .table-container table {
            margin: 0;
        }
    </style>
    
    <style>
    .calculation-section {
        margin-top: 20px;
        padding: 20px;
        background-color: #f9f9f9;
        border-radius: 10px;
        border: 1px solid #ddd;
    }

    .calculation-results {
        margin-top: 15px;
    }

    .calculation-results p {
        margin: 5px 0;
        font-size: 16px;
    }

    #result-status {
        font-weight: bold;
        font-size: 18px;
        margin-top: 10px;
    }
</style>

</head>
<body>
    <div class="container">
        <h1>2D Ledger Web Application</h1>
        
        <!-- List Table -->
        <h2>List Table</h2>
        <div class="table-container">
            <table id="list-table">
                <thead>
                    <tr>
                        
                        <th>Number</th>
                        <th>Money</th>
                        <th>Type</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Data will appear here -->
                </tbody>
            </table>
        </div>

        <!-- Input Section -->
        <div class="input-section">
            <div class="input-row">
                <div class="input-group">
                    <label for="number-input">Number</label>
                    <input type="number" id="number-input" maxlength="2" placeholder="00-99" pattern="[0-9]{2}">
                </div>
                <div class="input-group">
                    <label for="function-input">Function Sign</label>
                    <input type="text" id="function-input" placeholder="/ for reverse">
                </div>
                <div class="input-group">
                    <label for="money-input">Money</label>
                    <input type="number" id="money-input" min="0" placeholder="0">
                </div>
                <div class="input-group" id="r-money-group">
                    <label for="r-money-input">R Money</label>
                    <input type="number" id="r-money-input" min="0" placeholder="0">
                </div>
                <div class="input-group" id="ahkays-group">
                    <label for="ahkays-input">Ahkays Numbers</label>
                    <input type="text" id="ahkays-input" placeholder="e.g. 012">
                </div>
            </div>
            <div class="input-row">
                <div class="function-selector">
                    <button id="function-btn">ဒဲ့</button>
                    <div id="function-list" class="function-list">
                        <a>ဒဲ့</a>
                        <a>ဆတူအာ</a>
                        <a>အပူး</a>
                        <a>အပါ</a>
                        <a>ဘရိတ်</a>
                        <a>ပါဝါ</a>
                        <a>နက္ခ</a>
                        <a>ထိပ်</a>
                        <a>ပိတ်</a>
                        <a>ညီကို</a>
                        <a>ကိုညီ</a>
                        <a>အခွေ</a>
                        <a>အပူးပါအခွေ</a>
                    </div>
                </div>
                <button id="save-btn">Save (Enter)</button>
            </div>
        </div>

        <!-- Summary Section -->
        <div class="summary">
            <div class="summary-box">
                <h3>Total Money</h3>
                <p id="total-money">0</p>
            </div>
            <div class="summary-box">
                <h3>Break Money Limit</h3>
                <input type="number" id="break-limit" min="0" value="1000000">
                <button id="apply-limit-btn">Apply</button>
            </div>
            <div class="summary-box">
                <h3>Over Limit Total</h3>
                <p id="over-limit-total">0</p>
            </div>
        </div>

        <!-- Over Limit Table -->
        <h2>Over Limit Numbers</h2>
        <div class="table-container">
            <table id="over-limit-table">
                <thead>
                    <tr>
                        <th>Number</th>
                        <th>Original Amount</th>
                        <th>Over Amount</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Data will appear here -->
                </tbody>
            </table>
        </div>

   

        <!-- Number Sequence Table with Totals -->
        <h2>Number Sequence Table</h2>
        <div class="table-container">
            <table id="number-sequence-table">
                <thead>
                    <tr id="header-row">
                        <!-- Will be populated by JavaScript -->
                    </tr>
                </thead>
                <tbody>
                    <!-- Will be populated by JavaScript -->
                </tbody>
                <tfoot id="footer-row">
                   <!-- Total row will be added here -->
                </tfoot>
            </table>
        </div>
        
        <!-- Total Ledger Money Display -->
        <div class="total-ledger-row">
            Total Ledger Money: <span id="total-ledger-money">0</span>
        </div>
    </div>
    <div class="calculation-section">
    <h2>Profit/Loss Calculation</h2>
    <div class="input-row">
        <div class="input-group">
            <label for="commission-input">Commission (%)</label>
            <input type="number" id="commission-input" min="0" placeholder="0">
        </div>
        <div class="input-group">
            <label for="multiplier-input">Multiplier</label>
            <input type="number" id="multiplier-input" min="0" placeholder="0">
        </div>
        <div class="input-group">
            <label for="payout-input">Payout</label>
            <input type="number" id="payout-input" min="0" placeholder="0">
        </div>
    </div>
    <div class="calculation-results">
        <p>Total Ledger Money: <span id="display-total-ledger-money">0</span></p>
        <p>Commission Amount: <span id="commission-amount">0</span></p>
        <p>After Commission: <span id="after-commission">0</span></p>
        <p>After Payout: <span id="after-payout">0</span></p>
        <p>Profit/Loss: <span id="profit-loss">0</span></p>
        <p id="result-status"></p>
    </div>
</div>

     <button id="clear-all-btn" class="danger">Clear All Data</button>
<script>
        // DOM Elements
        const numberInput = document.getElementById('number-input');
        const functionInput = document.getElementById('function-input');
        const moneyInput = document.getElementById('money-input');
        const rMoneyGroup = document.getElementById('r-money-group');
        const rMoneyInput = document.getElementById('r-money-input');
        const ahkaysGroup = document.getElementById('ahkays-group');
        const ahkaysInput = document.getElementById('ahkays-input');
        const functionBtn = document.getElementById('function-btn');
        const saveBtn = document.getElementById('save-btn');
        const functionList = document.getElementById('function-list');
        const listTable = document.getElementById('list-table').getElementsByTagName('tbody')[0];
        const overLimitTable = document.getElementById('over-limit-table').getElementsByTagName('tbody')[0];
        const numberSequenceTable = document.getElementById('number-sequence-table');
        const headerRow = document.getElementById('header-row');
        const footerRow = document.getElementById('footer-row');
        const totalMoneyEl = document.getElementById('total-money');
        const breakLimitInput = document.getElementById('break-limit');
        const applyLimitBtn = document.getElementById('apply-limit-btn');
        const overLimitTotalEl = document.getElementById('over-limit-total');
        const clearAllBtn = document.getElementById('clear-all-btn');
        const totalLedgerMoneyEl = document.getElementById('total-ledger-money');
        
        // Data
        let numberMoneyData = JSON.parse(localStorage.getItem('numberMoneyData')) || [];
        let breakLimit = parseInt(localStorage.getItem('breakLimit')) || 1000000;
        let entryCounter = 1;

        // Initialize the app
        function initApp() {
            breakLimitInput.value = breakLimit;
            renderAllTables();
            updateTotalMoney();
            numberInput.focus();
        }

        // Auto-focus flow
        numberInput.addEventListener('input', function() {
            if (this.value.length === 2) {
                functionInput.focus();
            }
        });

        functionInput.addEventListener('input', function() {
            // Show R Money input based on function sign
            const funcSign = this.value;
            if (funcSign.includes('/')) {
                rMoneyGroup.style.display = 'block';
                ahkaysGroup.style.display = 'none';
                functionBtn.textContent = 'ဆတူအာ';
                functionBtn.style.backgroundColor = '#4CAF50';
                moneyInput.focus();
            } else if (funcSign.includes('+')) {
                rMoneyGroup.style.display = 'none';
                ahkaysGroup.style.display = 'none';
                functionBtn.textContent = 'အပူး';
                functionBtn.style.backgroundColor = '#FF9800';
                moneyInput.focus();
            } else if (funcSign.includes('a')) {
                rMoneyGroup.style.display = 'none';
                ahkaysGroup.style.display = 'none';
                functionBtn.textContent = 'အပါ';
                functionBtn.style.backgroundColor = '#9C27B0';
                moneyInput.focus();
            } else if (funcSign.includes('b')) {
                rMoneyGroup.style.display = 'none';
                ahkaysGroup.style.display = 'none';
                functionBtn.textContent = 'ဘရိတ်';
                functionBtn.style.backgroundColor = '#607d8b';
                moneyInput.focus();
            } else if (funcSign.includes('p')) {
                rMoneyGroup.style.display = 'none';
                ahkaysGroup.style.display = 'none';
                functionBtn.textContent = 'ပါဝါ';
                functionBtn.style.backgroundColor = '#5C6BC0';
                moneyInput.focus();
            } else if (funcSign.includes('k')) {
                rMoneyGroup.style.display = 'none';
                ahkaysGroup.style.display = 'none';
                functionBtn.textContent = 'နက္ခ';
                functionBtn.style.backgroundColor = '#26A69A';
                moneyInput.focus();
            } else if (funcSign.includes('t')) {
                rMoneyGroup.style.display = 'none';
                ahkaysGroup.style.display = 'none';
                functionBtn.textContent = 'ထိပ်';
                functionBtn.style.backgroundColor = '#FF5722';
                moneyInput.focus();
            } else if (funcSign.includes('d')) {
                rMoneyGroup.style.display = 'none';
                ahkaysGroup.style.display = 'none';
                functionBtn.textContent = 'ပိတ်';
                functionBtn.style.backgroundColor = '#795548';
                moneyInput.focus();
            } else if (funcSign.includes('sg')) {
                rMoneyGroup.style.display = 'none';
                ahkaysGroup.style.display = 'none';
                functionBtn.textContent = 'ညီကို';
                functionBtn.style.backgroundColor = '#EC407A';
                moneyInput.focus();
            } else if (funcSign.includes('gs')) {
                rMoneyGroup.style.display = 'none';
                ahkaysGroup.style.display = 'none';
                functionBtn.textContent = 'ကိုညီ';
                functionBtn.style.backgroundColor = '#AB47BC';
                moneyInput.focus();
            } else if (funcSign.includes('x')) {
                rMoneyGroup.style.display = 'none';
                ahkaysGroup.style.display = 'block';
                functionBtn.textContent = 'အခွေ';
                functionBtn.style.backgroundColor = '#8D6E63';
                moneyInput.focus();
            } else if (funcSign.includes('z')) {
                rMoneyGroup.style.display = 'none';
                ahkaysGroup.style.display = 'block';
                functionBtn.textContent = 'အပူးပါအခွေ';
                functionBtn.style.backgroundColor = '#7E57C2';
                moneyInput.focus();
            } else {
                rMoneyGroup.style.display = 'none';
                ahkaysGroup.style.display = 'none';
                functionBtn.textContent = 'ဒဲ့';
                functionBtn.style.backgroundColor = '#2196F3';
            }
        });

        // Function list toggle
        functionBtn.addEventListener('click', function(e) {
            e.stopPropagation();
            functionList.classList.toggle('show');
        });

        // Select function from list
        document.querySelectorAll('.function-list a').forEach(item => {
            item.addEventListener('click', function() {
                functionInput.value = this.textContent;
                functionBtn.textContent = this.textContent;
                functionList.classList.remove('show');
                
                if (this.textContent === 'ဆတူအာ') {
                    functionInput.value = '/';
                    rMoneyGroup.style.display = 'block';
                    ahkaysGroup.style.display = 'none';
                    functionBtn.style.backgroundColor = '#4CAF50';
                    moneyInput.focus();
                } else if (this.textContent === 'အပူး') {
                    functionInput.value = '+';
                    rMoneyGroup.style.display = 'none';
                    ahkaysGroup.style.display = 'none';
                    functionBtn.style.backgroundColor = '#FF9800';
                    moneyInput.focus();
                } else if (this.textContent === 'အပါ') {
                    functionInput.value = 'a';
                    rMoneyGroup.style.display = 'none';
                    ahkaysGroup.style.display = 'none';
                    functionBtn.style.backgroundColor = '#9C27B0';
                    moneyInput.focus();
                } else if (this.textContent === 'ဘရိတ်') {
                    functionInput.value = 'b';
                    rMoneyGroup.style.display = 'none';
                    ahkaysGroup.style.display = 'none';
                    functionBtn.style.backgroundColor = '#607d8b';
                    moneyInput.focus();
                } else if (this.textContent === 'ပါဝါ') {
                    functionInput.value = 'p';
                    rMoneyGroup.style.display = 'none';
                    ahkaysGroup.style.display = 'none';
                    functionBtn.style.backgroundColor = '#5C6BC0';
                    moneyInput.focus();
                } else if (this.textContent === 'နက္ခ') {
                    functionInput.value = 'k';
                    rMoneyGroup.style.display = 'none';
                    ahkaysGroup.style.display = 'none';
                    functionBtn.style.backgroundColor = '#26A69A';
                    moneyInput.focus();
                } else if (this.textContent === 'ထိပ်') {
                    functionInput.value = 't';
                    rMoneyGroup.style.display = 'none';
                    ahkaysGroup.style.display = 'none';
                    functionBtn.style.backgroundColor = '#FF5722';
                    moneyInput.focus();
                } else if (this.textContent === 'ပိတ်') {
                    functionInput.value = 'd';
                    rMoneyGroup.style.display = 'none';
                    ahkaysGroup.style.display = 'none';
                    functionBtn.style.backgroundColor = '#795548';
                    moneyInput.focus();
                } else if (this.textContent === 'ညီကို') {
                    functionInput.value = 'sg';
                    rMoneyGroup.style.display = 'none';
                    ahkaysGroup.style.display = 'none';
                    functionBtn.style.backgroundColor = '#EC407A';
                    moneyInput.focus();
                } else if (this.textContent === 'ကိုညီ') {
                    functionInput.value = 'gs';
                    rMoneyGroup.style.display = 'none';
                    ahkaysGroup.style.display = 'none';
                    functionBtn.style.backgroundColor = '#AB47BC';
                    moneyInput.focus();
                } else if (this.textContent === 'အခွေ') {
                    functionInput.value = 'x';
                    rMoneyGroup.style.display = 'none';
                    ahkaysGroup.style.display = 'block';
                    functionBtn.style.backgroundColor = '#8D6E63';
                    moneyInput.focus();
                } else if (this.textContent === 'အပူးပါအခွေ') {
                    functionInput.value = 'z';
                    rMoneyGroup.style.display = 'none';
                    ahkaysGroup.style.display = 'block';
                    functionBtn.style.backgroundColor = '#7E57C2';
                    moneyInput.focus();
                } else {
                    rMoneyGroup.style.display = 'none';
                    ahkaysGroup.style.display = 'none';
                    functionBtn.style.backgroundColor = '#2196F3';
                }
            });
        });

        // Close function list when clicking outside
        window.addEventListener('click', function() {
            functionList.classList.remove('show');
        });

        // Reverse number digits (12 -> 21)
        function reverseNumber(num) {
            return num.split('').reverse().join('');
        }

        // Get all numbers with same first digit (for 't' - ထိပ်)
        function getPrefixNumbers(number) {
            const prefix = number.charAt(0);
            let numbers = [];
            
            // Add all numbers with same first digit (10-19 for prefix 1)
            for (let i = 0; i < 10; i++) {
                numbers.push(prefix + i);
            }
            
            return numbers;
        }

        // Get all numbers with same first or second digit (for 'a' - အပါ)
        function getAPANumbers(number) {
            const firstDigit = number.charAt(0);
            const secondDigit = number.charAt(1);
            let numbers = new Set();
            
            // Add all numbers with same first digit
            for (let i = 0; i < 10; i++) {
                numbers.add(firstDigit + i);
            }
            
            // Add all numbers with same second digit
            for (let i = 0; i < 10; i++) {
                numbers.add(i + secondDigit);
            }
            
            return Array.from(numbers);
        }

        // Get all numbers with same last digit (for 'd' - ပိတ်)
        function getSuffixNumbers(number) {
            const suffix = number.charAt(1);
            let numbers = [];
            
            // Add all numbers with same last digit (01, 11, 21,...91)
            for (let i = 0; i < 10; i++) {
                numbers.push(i.toString() + suffix);
            }
            
            return numbers;
        }

        // Get all numbers where last digit of sum equals last digit of input number's sum
        function getBreakNumbers(number) {
            // Calculate sum of digits
            const digit1 = parseInt(number.charAt(0));
            const digit2 = parseInt(number.charAt(1));
            const sum = digit1 + digit2;
            const lastDigit = sum % 10; // Get last digit of sum
            
            let numbers = [];
            
            // Find all numbers where sum of digits ends with the same last digit
            for (let i = 0; i < 10; i++) {
                for (let j = 0; j < 10; j++) {
                    if ((i + j) % 10 === lastDigit) {
                        const num = i.toString() + j.toString();
                        numbers.push(num);
                    }
                }
            }
            
            return numbers;
        }

        // Get all power numbers (05, 16, 27, 38, 49, 50, 61, 72, 83, 94)
        function getPowerNumbers() {
            return ['05', '16', '27', '38', '49', '50', '61', '72', '83', '94'];
        }

        // Get all nacca numbers (07, 18, 24, 35, 42, 53, 69, 70, 81, 96)
        function getNaccaNumbers() {
            return ['07', '18', '24', '35', '42', '53', '69', '70', '81', '96'];
        }

        // Get brother numbers (01, 12, 23, 34, 45, 56, 67, 78, 89, 90)
        function getBrotherNumbers() {
            return ['01', '12', '23', '34', '45', '56', '67', '78', '89', '90'];
        }

        // Get reverse brother numbers (10, 21, 32, 43, 54, 65, 76, 87, 98, 09)
        function getReverseBrotherNumbers() {
            return ['10', '21', '32', '43', '54', '65', '76', '87', '98', '09'];
        }

        // Get all possible 2-digit combinations from a string of digits (for Ahkway)
        function getAhkwayNumbers(digits) {
            let numbers = new Set();
            
            // Generate all possible 2-digit combinations
            for (let i = 0; i < digits.length; i++) {
                for (let j = 0; j < digits.length; j++) {
                    if (i !== j) {
                        numbers.add(digits[i] + digits[j]);
                    }
                }
            }
            
            return Array.from(numbers);
        }

        // Get all possible 2-digit combinations including identical numbers (for Ahput Par Ahkway)
        function getAhputParAhkwayNumbers(digits) {
            let numbers = new Set();
            
            // Generate all possible 2-digit combinations including identical numbers
            for (let i = 0; i < digits.length; i++) {
                for (let j = 0; j < digits.length; j++) {
                    numbers.add(digits[i] + digits[j]);
                }
            }
            
            return Array.from(numbers);
        }
        // Calculate total money for a number
        function calculateMoneyForNumber(number) {
            return numberMoneyData
                .filter(item => item.number === number)
                .reduce((sum, item) => sum + parseInt(item.money), 0);
        }

        // Render all tables
        function renderAllTables() {
            renderListTable();
            renderNumberSequenceTable();
            updateOverLimitTable();
        }

        // Render list table
        function renderListTable() {
            listTable.innerHTML = '';
            entryCounter = 1;
            
            numberMoneyData.forEach((item, index) => {
                const row = listTable.insertRow();
                if (item.type === 'Main') row.classList.add('main-entry');
                if (item.type === 'Reversed') row.classList.add('r-entry');
                if (item.type === 'Identical') row.classList.add('identical-entry');
                if (item.type === 'Prefix') row.classList.add('prefix-entry');
                if (item.type === 'Suffix') row.classList.add('suffix-entry');
                if (item.type === 'Break') row.classList.add('break-entry');
                if (item.type === 'Power') row.classList.add('power-entry');
                if (item.type === 'Nacca') row.classList.add('nacca-entry');
                if (item.type === 'APa') row.classList.add('prefix-entry');
                if (item.type === 'Brother') row.classList.add('brother-entry');
                if (item.type === 'ReverseBrother') row.classList.add('reverse-brother-entry');
                if (item.type === 'Ahkway') row.classList.add('ahkway-entry');
                if (item.type === 'Ahput Par Ahkway') row.classList.add('ahput-par-ahkway-entry');
                
                //row.insertCell(0).textContent = entryCounter++;
                row.insertCell(0).textContent = item.number;
                row.insertCell(1).textContent = item.money;
                row.insertCell(2).textContent = item.type || 'Normal';
                
                const actionsCell = row.insertCell(3);
                
                const editBtn = document.createElement('button');
                editBtn.textContent = 'Edit';
                editBtn.addEventListener('click', () => editItem(index));
                actionsCell.appendChild(editBtn);
                
                const deleteBtn = document.createElement('button');
                deleteBtn.textContent = 'Delete';
                deleteBtn.classList.add('danger');
                deleteBtn.addEventListener('click', () => deleteItem(index));
                actionsCell.appendChild(deleteBtn);
            });
        }

        // Render number sequence table with totals
        function renderNumberSequenceTable() {
            headerRow.innerHTML = '';
            numberSequenceTable.getElementsByTagName('tbody')[0].innerHTML = '';
            footerRow.innerHTML = '';
            
            // Create header
            for (let i = 0; i < 10; i++) {
                headerRow.appendChild(document.createElement('th')).textContent = 'Number';
                headerRow.appendChild(document.createElement('th')).textContent = 'Money';
            }
            
            // Create rows and calculate totals
            const columnTotals = Array(10).fill(0);
            let grandTotal = 0;
            
            for (let rowNum = 0; rowNum < 10; rowNum++) {
                const row = numberSequenceTable.getElementsByTagName('tbody')[0].insertRow();
                
                for (let colNum = 0; colNum < 10; colNum++) {
                    const number = (colNum * 10 + rowNum).toString().padStart(2, '0');
                    const totalMoney = calculateMoneyForNumber(number);
                    const displayMoney = totalMoney > breakLimit ? breakLimit : totalMoney;
                    
                    // Number cell
                    row.insertCell().textContent = number;
                    
                    // Money cell
                    const moneyCell = row.insertCell();
                    moneyCell.textContent = displayMoney;
                    
                    if (totalMoney > breakLimit) {
                        moneyCell.classList.add('over-limit-cell');
                    }
                    
                    // Add to column total and grand total
                    columnTotals[colNum] += displayMoney;
                    grandTotal += displayMoney;
                }
            }
            
            // Create footer row with column totals
            const footer = footerRow.insertRow();
            footer.insertCell().textContent = 'Total';
            footer.insertCell().classList.add('total-cell');
            
            for (let colNum = 0; colNum < 10; colNum++) {
                footer.insertCell().textContent = columnTotals[colNum];
                footer.insertCell().classList.add('total-cell');
            }
            
            // Update grand total display
            totalLedgerMoneyEl.textContent = grandTotal;
        }

        // Update over limit table
        function updateOverLimitTable() {
            overLimitTable.innerHTML = '';
            let overLimitTotal = 0;
            
            for (let i = 0; i < 100; i++) {
                const number = i.toString().padStart(2, '0');
                const totalMoney = calculateMoneyForNumber(number);
                
                if (totalMoney > breakLimit) {
                    const overAmount = totalMoney - breakLimit;
                    overLimitTotal += overAmount;
                    
                    const row = overLimitTable.insertRow();
                    row.insertCell(0).textContent = number;
                    row.insertCell(1).textContent = totalMoney;
                    row.insertCell(2).textContent = overAmount;
                }
            }
            
            overLimitTotalEl.textContent = overLimitTotal;
        }

        // Update total money
        function updateTotalMoney() {
            const total = numberMoneyData.reduce((sum, item) => sum + parseInt(item.money), 0);
            totalMoneyEl.textContent = total;
        }

        // Save data
        function saveData() {
            const number = numberInput.value;
            const money = (moneyInput.value)*100;
            const rMoney = (rMoneyInput.value)*100;
            const ahkays = ahkaysInput.value;

            if (!number || number.length !== 2 || isNaN(number)) {
                alert('Please enter a valid 2-digit number');
                numberInput.focus();
                return;
            }

            if (!money || isNaN(money) || money < 0) {
                alert('Please enter a valid money amount');
                moneyInput.focus();
                return;
            }

            const funcSign = functionInput.value;
            if (funcSign.includes('/')) {
                // Add main entry
                numberMoneyData.push({
                    number: number,
                    money: money,
                    type: 'Main'
                });
                
                // Add reversed entry
                const reversedNumber = reverseNumber(number);
                const rMoneyValue = rMoney && !isNaN(rMoney) ? rMoney : money;
                numberMoneyData.push({
                    number: reversedNumber,
                    money: rMoneyValue,
                    type: 'Reversed'
                });
            } else if (funcSign.includes('+')) {
                // Add entries for all identical numbers (00, 11, 22, etc.)
                for (let i = 0; i < 10; i++) {
                    const identicalNumber = i.toString() + i.toString();
                    numberMoneyData.push({
                        number: identicalNumber,
                        money: money,
                        type: 'Identical'
                    });
                }
            } else if (funcSign.includes('a')) {
                // Add entries for all numbers with same first OR second digit (အပါ)
                const apaNumbers = getAPANumbers(number);
                apaNumbers.forEach(num => {
                    numberMoneyData.push({
                        number: num,
                        money: money,
                        type: 'APa'
                    });
                });
            } else if (funcSign.includes('t')) {
                // Add entries for all numbers with same first digit (ထိပ်)
                const prefixNumbers = getPrefixNumbers(number);
                prefixNumbers.forEach(num => {
                    numberMoneyData.push({
                        number: num,
                        money: money,
                        type: 'Prefix'
                    });
                });
            } else if (funcSign.includes('d')) {
                // Add entries for all numbers with same last digit (ပိတ်)
                const suffixNumbers = getSuffixNumbers(number);
                suffixNumbers.forEach(num => {
                    numberMoneyData.push({
                        number: num,
                        money: money,
                        type: 'Suffix'
                    });
                });
            } else if (funcSign.includes('b')) {
                // Add entries for all numbers where sum of digits has same last digit
                const breakNumbers = getBreakNumbers(number);
                breakNumbers.forEach(num => {
                    numberMoneyData.push({
                        number: num,
                        money: money,
                        type: 'Break'
                    });
                });
            } else if (funcSign.includes('p')) {
                // Add entries for all power numbers
                const powerNumbers = getPowerNumbers();
                powerNumbers.forEach(num => {
                    numberMoneyData.push({
                        number: num,
                        money: money,
                        type: 'Power'
                    });
                });
            } else if (funcSign.includes('k')) {
                // Add entries for all nacca numbers
                const naccaNumbers = getNaccaNumbers();
                naccaNumbers.forEach(num => {
                    numberMoneyData.push({
                        number: num,
                        money: money,
                        type: 'Nacca'
                    });
                });
            } else if (funcSign.includes('sg')) {
                // Add entries for all brother numbers (01, 12, 23, etc.)
                const brotherNumbers = getBrotherNumbers();
                brotherNumbers.forEach(num => {
                    numberMoneyData.push({
                        number: num,
                        money: money,
                        type: 'Brother'
                    });
                });
            } else if (funcSign.includes('gs')) {
                // Add entries for all reverse brother numbers (10, 21, 32, etc.)
                const reverseBrotherNumbers = getReverseBrotherNumbers();
                reverseBrotherNumbers.forEach(num => {
                    numberMoneyData.push({
                        number: num,
                        money: money,
                        type: 'ReverseBrother'
                    });
                });
            } else if (funcSign.includes('x')) {
                // Add entries for all Ahkway combinations
                if (!ahkays || ahkays.length < 2) {
                    alert('Please enter at least 2 digits for Ahkway');
                    ahkaysInput.focus();
                    return;
                }
                
                const ahkwayNumbers = getAhkwayNumbers(ahkays);
                ahkwayNumbers.forEach(num => {
                    numberMoneyData.push({
                        number: num,
                        money: money,
                        type: 'Ahkway'
                    });
                });
            } else if (funcSign.includes('z')) {
                // Add entries for all Ahput Par Ahkway combinations
                if (!ahkays || ahkays.length < 2) {
                    alert('Please enter at least 2 digits for Ahput Par Ahkway');
                    ahkaysInput.focus();
                    return;
                }
                
                const ahputParAhkwayNumbers = getAhputParAhkwayNumbers(ahkays);
                ahputParAhkwayNumbers.forEach(num => {
                    numberMoneyData.push({
                        number: num,
                        money: money,
                        type: 'Ahput Par Ahkway'
                    });
                });
            } else {
                // Add single entry
                numberMoneyData.push({
                    number: number,
                    money: money,
                    type: 'Normal'
                });
            }

            // Save to localStorage
            localStorage.setItem('numberMoneyData', JSON.stringify(numberMoneyData));
            
            // Clear inputs and update UI
            clearInputs();
            renderAllTables();
            updateTotalMoney();
             
             const tableContainer = document.querySelector('.table-container');
if (tableContainer) {
    tableContainer.scrollTop = tableContainer.scrollHeight;
}


        }



       // Edit item
function editItem(index) {
    const item = numberMoneyData[index];
    
    // Populate form with selected item data
    numberInput.value = item.number;
    moneyInput.value = (item.money)/100;
    functionInput.value = '';
    rMoneyGroup.style.display = 'none';
    ahkaysGroup.style.display = 'none';
    functionBtn.textContent = 'ဒဲ့';
    functionBtn.style.backgroundColor = '#2196F3';

    // Adjust function based on entry type
    if (item.type === 'Main') {
        functionInput.value = '';
        rMoneyGroup.style.display = 'block';
        functionBtn.textContent = 'ဆတူအာ';
        functionBtn.style.backgroundColor = '#4CAF50';
        
        // Look for reversed entry but don't auto-delete
        const reversedNumber = reverseNumber(item.number);
        const reversedEntry = numberMoneyData.find(entry => 
            entry.number === reversedNumber && entry.type === 'Reversed'
        );
        
        if (reversedEntry) {
            rMoneyInput.value = reversedEntry.money;
        }
    } else if (item.type === 'Identical') {
        functionInput.value = '';
        functionBtn.textContent = 'အပူး';
        functionBtn.style.backgroundColor = '#FF9800';
    }
    // ... other types ...

    // Remove only the selected item
    numberMoneyData.splice(index, 1);

    // Update storage and UI
    localStorage.setItem('numberMoneyData', JSON.stringify(numberMoneyData));
    renderAllTables();
    updateTotalMoney();
    numberInput.focus();
}




        // Delete item
function deleteItem(index) {
    if (confirm('Are you sure you want to delete this item?')) {
        const item = numberMoneyData[index];
        
        // Remove only the selected item
        numberMoneyData.splice(index, 1);
        
        // Update local storage
        localStorage.setItem('numberMoneyData', JSON.stringify(numberMoneyData));
        renderAllTables();
        updateTotalMoney();
    }
}

        // Apply break limit
        function applyBreakLimit() {
            const newLimit = parseInt(breakLimitInput.value);
            
            if (isNaN(newLimit) || newLimit < 0) {
                alert('Please enter a valid positive number');
                return;
            }
            
            breakLimit = newLimit;
            localStorage.setItem('breakLimit', breakLimit.toString());
            
            renderNumberSequenceTable();
            updateOverLimitTable();
        }

        // Clear all data
        function clearAllData() {
            if (confirm('Are you sure you want to delete ALL data? This cannot be undone.')) {
                numberMoneyData = [];
            breakLimit = 1000000;
            breakLimitInput.value = '1000000';
            
            localStorage.removeItem('numberMoneyData');
            localStorage.removeItem('breakLimit');
            
            clearInputs();
            renderAllTables();
            updateTotalMoney();
        }
    }

    // Clear input fields
    function clearInputs() {
        numberInput.value = '';
        functionInput.value = '';
        moneyInput.value = '';
        rMoneyInput.value = '';
        ahkaysInput.value = '';
        rMoneyGroup.style.display = 'none';
        ahkaysGroup.style.display = 'none';
        functionBtn.textContent = 'ဒဲ့';
        functionBtn.style.backgroundColor = '#2196F3';
        numberInput.focus();



    }

    // Event listeners
    saveBtn.addEventListener('click', saveData);
    applyLimitBtn.addEventListener('click', applyBreakLimit);
    clearAllBtn.addEventListener('click', clearAllData);
    
    // Handle Enter key
    moneyInput.addEventListener('keypress', function(e) {
        if (e.key === 'Enter') saveData();
    });
    
    rMoneyInput.addEventListener('keypress', function(e) {
        if (e.key === 'Enter') saveData();
    });

    ahkaysInput.addEventListener('keypress', function(e) {
        if (e.key === 'Enter') saveData();
    });


    // Initialize app
    initApp();
</script>
<script>
    // DOM Elements for Calculation Section
    const commissionInput = document.getElementById('commission-input');
    const multiplierInput = document.getElementById('multiplier-input');
    const payoutInput = document.getElementById('payout-input');
    const displayTotalLedgerMoney = document.getElementById('display-total-ledger-money');
    const commissionAmount = document.getElementById('commission-amount');
    const afterCommission = document.getElementById('after-commission');
    const afterPayout = document.getElementById('after-payout');
    const profitLoss = document.getElementById('profit-loss');
    const resultStatus = document.getElementById('result-status');

    // Event Listeners for Input Changes
    commissionInput.addEventListener('input', updateCalculations);
    multiplierInput.addEventListener('input', updateCalculations);
    payoutInput.addEventListener('input', updateCalculations);

    // Function to Update Calculations
    function updateCalculations() {
        // Get values from inputs
        const totalLedgerMoney = parseFloat(totalLedgerMoneyEl.textContent) || 0;
        const commission = parseFloat(commissionInput.value) || 0;
        const multiplier = parseFloat(multiplierInput.value) || 0;
        const payout = parseFloat(payoutInput.value) || 0;

        // Display Total Ledger Money
        displayTotalLedgerMoney.textContent = totalLedgerMoney;

        // Calculate Commission Amount
        const commissionValue = (totalLedgerMoney * commission) / 100;
        commissionAmount.textContent = commissionValue.toFixed();

        // Calculate After Commission
        const afterCommissionValue = totalLedgerMoney - commissionValue;
        afterCommission.textContent = afterCommissionValue.toFixed();

        // Calculate After Payout
        const afterPayoutValue = afterCommissionValue - (payout * multiplier);
        afterPayout.textContent = afterPayoutValue.toFixed();

        // Calculate Profit/Loss
        profitLoss.textContent = afterPayoutValue.toFixed();

        // Determine Result Status
        if (afterPayoutValue < 0) {
            resultStatus.textContent = "Loss";
            resultStatus.style.color = "red";
        } else {
            resultStatus.textContent = "Profit";
            resultStatus.style.color = "green";
        }
    }

    // Initialize Calculations
    updateCalculations();
</script>

</body>
</html>